# Story 2.3: ETS & Croston/TSB Statistical Models

## Status

Done

## Executor Assignment

executor: "@dev"
quality_gate: "@architect"
quality_gate_tools: ["pytest", "ruff", "mypy"]

## Story

**As a** demand planner,
**I want** the system to provide ETS (Holt-Winters), Croston, and TSB statistical forecast models,
**so that** Class C SKUs, intermittent demand, and lumpy demand products get accurate forecasts using proven statistical methods.

## References

- FR-025: ETS Model (Holt-Winters) — statsmodels ExponentialSmoothing
- FR-026: Croston/TSB Model — for intermittent/lumpy demand
- CON-005: Intermittent demand (>25% zeros) cannot use TFT
- NFR-004: Class C MAPE < 35%

## Acceptance Criteria

1. [x] ETS model implements AbstractForecastModel interface (train/predict/backtest)
2. [x] ETS uses statsmodels ExponentialSmoothing with auto AIC variant selection (additive vs multiplicative)
3. [x] ETS generates quantile intervals via simulation (1000 paths)
4. [x] Croston model implements AbstractForecastModel interface
5. [x] Croston decomposes demand into inter-demand interval and demand size
6. [x] TSB model implements AbstractForecastModel with exponential decay
7. [x] Both Croston and TSB generate intervals via bootstrap
8. [x] SBA (Syntetos-Boylan Approximation) fallback available as Croston variant
9. [x] All models produce ForecastResult with p10, p25, p50, p75, p90 quantiles
10. [x] Naive model implements AbstractForecastModel as simplest baseline
11. [x] Unit tests >= 80% coverage with deterministic seed for reproducibility

## Tasks / Subtasks

- [x] **Task 1: Implement ETS model**
  - [x] `models/ets/ets_model.py` — ExponentialSmoothing wrapper
  - [x] Auto AIC variant selection
  - [x] Simulation-based quantile intervals (1000 paths)
- [x] **Task 2: Implement Croston model**
  - [x] `models/croston/croston_model.py` — Croston decomposition
  - [x] SBA variant support
  - [x] Bootstrap-based quantile intervals
- [x] **Task 3: Implement TSB model**
  - [x] TSB with exponential decay in croston_model.py
- [x] **Task 4: Implement Naive baseline**
  - [x] `models/naive/naive_model.py` — simple last-value/moving average
- [x] **Task 5: Write unit tests**
  - [x] Test ETS with known seasonal data
  - [x] Test Croston with intermittent data
  - [x] Test TSB with lumpy data
  - [x] Test Naive baseline
  - [x] Test quantile output format

## File List

| File | Action |
|------|--------|
| `apps/forecast-engine/src/models/ets/__init__.py` | Created |
| `apps/forecast-engine/src/models/ets/ets_model.py` | Created |
| `apps/forecast-engine/src/models/croston/__init__.py` | Created |
| `apps/forecast-engine/src/models/croston/croston_model.py` | Created |
| `apps/forecast-engine/src/models/naive/__init__.py` | Created |
| `apps/forecast-engine/src/models/naive/naive_model.py` | Created |
| `apps/forecast-engine/tests/test_ets_model.py` | Created |
| `apps/forecast-engine/tests/test_croston_model.py` | Created |
| `apps/forecast-engine/tests/test_naive_model.py` | Created |

## Quality Gate Results

| Gate | Result |
|------|--------|
| ruff check | PASS — 0 errors |
| mypy --strict | PASS — 0 issues (6 files) |
| pytest | PASS — 42/42 tests |
| Coverage (ets_model.py) | 93% |
| Coverage (croston_model.py) | 95% |
| Coverage (naive_model.py) | 92% |

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-26 | 0.1 | Story created | River (SM) |
| 2026-02-26 | 1.0 | Implementation complete, all quality gates pass | Dex (Dev) |
