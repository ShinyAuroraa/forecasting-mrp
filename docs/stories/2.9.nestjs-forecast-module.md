# Story 2.9: NestJS Forecast Module & Execution API

## Status

Done

## Executor Assignment

executor: "@dev"
quality_gate: "@architect"
quality_gate_tools: ["jest", "eslint", "tsc"]

## Story

**As a** demand planner,
**I want** a REST API to trigger forecasts, view execution status, and access stored results,
**so that** I can orchestrate forecast runs from the frontend and monitor their progress.

## References

- FR-030: NestJS-FastAPI Integration via BullMQ
- FR-032: Forecast Metrics Storage
- FR-033: Model Metadata Storage

## Acceptance Criteria

1. [x] ForecastModule registered in AppModule
2. [x] POST /forecast/execute triggers a new execution (returns 202)
3. [x] GET /forecast/executions lists executions with pagination
4. [x] GET /forecast/executions/:id returns execution details with steps
5. [x] GET /forecast/metrics returns stored metrics with filters
6. [x] GET /forecast/models returns model metadata list
7. [x] DTOs with class-validator validation
8. [x] Unit tests >= 80% coverage

## File List

| File | Action |
|------|--------|
| `apps/api/src/modules/forecast/forecast.module.ts` | Created |
| `apps/api/src/modules/forecast/forecast.controller.ts` | Created |
| `apps/api/src/modules/forecast/forecast.service.ts` | Created |
| `apps/api/src/modules/forecast/forecast.repository.ts` | Created |
| `apps/api/src/modules/forecast/forecast.interfaces.ts` | Created |
| `apps/api/src/modules/forecast/dto/execute-forecast.dto.ts` | Created |
| `apps/api/src/modules/forecast/dto/filter-execution.dto.ts` | Created |
| `apps/api/src/modules/forecast/dto/filter-metrics.dto.ts` | Created |
| `apps/api/src/modules/forecast/dto/filter-models.dto.ts` | Created |
| `apps/api/src/modules/forecast/forecast.controller.spec.ts` | Created |
| `apps/api/src/modules/forecast/forecast.service.spec.ts` | Created |
| `apps/api/src/modules/forecast/forecast.repository.spec.ts` | Created |
| `apps/api/src/app.module.ts` | Modified (added ForecastModule) |

## Quality Gate Results

| Gate | Result |
|------|--------|
| eslint | PASS — 0 errors |
| tsc --noEmit | PASS — 0 issues |
| jest | PASS — 42/42 tests |
| Coverage (controller) | 100% |
| Coverage (service) | 100% |
| Coverage (repository) | 100% Stmts, 63% Branch |
| Coverage (DTOs) | 100% |
| Coverage (module total) | 92.78% Stmts, 93.9% Lines |

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-26 | 0.1 | Story created | River (SM) |
| 2026-02-26 | 1.0 | Implementation complete, all quality gates pass | Dex (Dev) |
